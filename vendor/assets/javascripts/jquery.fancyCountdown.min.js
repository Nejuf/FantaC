/*!
 * Fancy Countdown v1.3
 *
 * Copyright 2011, Rafael Dery
 *
 * Only for sale at the envato marketplaces
 */

(function(c){c.fancyCountdown={version:"1.3"};c.fn.fancyCountdown=function(O){function P(){N=Date.UTC(a.year,a.month-1,a.day,a.hour-a.timezone,a.minute,a.second);var d=N-(new Date).getTime(),g=Math.floor(d/1E3),h=Math.floor(g/60),b=Math.floor(h/60),k=Math.floor(b/24),g=g%60,h=h%60,b=b%24,y=Math.floor(g%10),g=Math.floor(g/10),f=Math.floor(h%10),h=Math.floor(h/10),j=Math.floor(b%10),b=Math.floor(b/10),z=Math.floor(k%10),A=Math.floor(Math.floor(k/10)%10),k=Math.floor(k/100);if(!B){D=y;E=g;F=f;G=h;H= j;I=b;J=z;K=A;L=k;for(var n=-2,m=0;4>m;++m)a.digits.seconds&&(p&&p[m].text(e(y+n,0,9)),q&&q[m].text(e(g+n,0,5))),a.digits.minutes&&(r&&r[m].text(e(f+n,0,9)),s&&s[m].text(e(h+n,0,5))),a.digits.hours&&(t&&t[m].text(e(j+n,0,9)),u&&u[m].text(e(b+n,0,2))),a.digits.days&&(v&&v[m].text(e(z+n,0,9)),w&&w[m].text(e(A+n,0,9)),x&&x[m].text(e(k+n,0,9))),++n}B=!0;0<d?(D!=y&&(p&&l(p,e(y-2,0,9)),D=y),E!=g&&q&&(l(q,e(g-2,0,5)),E=g),F!=f&&r&&(l(r,e(f-2,0,9)),F=f),G!=h&&s&&(l(s,e(h-2,0,5)),G=h),H!=j&&t&&(l(t,e(j-2, 0,9)),H=j),I!=b&&u&&(l(u,e(b-2,0,2)),I=b),J!=z&&v&&(l(v,e(z-2,0,9)),J=z),K!=A&&w&&(l(w,e(A-2,0,9)),K=A),L!=k&&x&&(l(x,e(k-2,0,9)),L=k)):(c.fancyCountdown.stop(),c.fancyCountdown.reset(),a.callback())}function l(d,a){var h=d[0].height(),e=parseInt(b.children(".fc-digit-offset").css("top")),f=parseInt(b.children(".fc-digit-offset").css("bottom"));d[0].animate({top:-(h-e)+"px"},300);d[1].animate({top:"0px"},300);d[2].animate({top:h-f+"px"},300);d[3].animate({top:h+"px"},300,function(){var b=d.pop(); c(b).css("top",-c(b).height()+"px");b.text(a);d.unshift(b)})}function e(d,a,b){return 0>d?b+d+1:d>b?a+d-b-1:d}function f(){b.children("div:last").append("<div style='background:"+a.fillColor+"; border-color: "+a.borderColor+";' class='fc-digitUnit fc-width fc-height'><ul class='fc-digits'><li>8</li><li>9</li><li>0</li><li>1</li></ul><img src='"+a.overlayImageUrl+"' class='fc-digitOverlay' /></div>");var d=b.children("div:last").children("div:last").find(".fc-digits li").addClass("fc-height fc-font"), g=[];digitHeight=c(d[0]).height();offsetTop=parseInt(b.children(".fc-digit-offset").css("top"));offsetBottom=parseInt(b.children(".fc-digit-offset").css("bottom"));g[0]=c(d[0]).css("top",-digitHeight);g[1]=c(d[1]).css("top",-(digitHeight-offsetTop));g[2]=c(d[2]).css("top","0");g[3]=c(d[3]).css("top",digitHeight-offsetBottom);return g}function M(){b.children("div:last").append('<div style="background:'+a.fillColor+"; border-color: "+a.borderColor+';" class="fc-colon fc-height fc-colon-width"><div class="fc-height fc-font">:</div><img src="'+ a.overlayImageUrl+'" class="fc-digitOverlay" /></div>')}function C(d,a){var b=a.width();a.children(".fc-colon").size()&&(b-=a.children(".fc-colon").width()+4*parseInt(a.children(".fc-colon").css("marginRight")));a.append('<span class="fc-captions" style="width: '+b+'px;">'+d+"</span>")}var a=c.extend({},c.fn.fancyCountdown.defaults,O),b,j,N,B=!1,D,E,F,G,H,I,J,K,L,p,q,r,s,t,u,v,w,x;c.fancyCountdown.start=function(){j||(B=!1,j=setInterval(P,100))};c.fancyCountdown.stop=function(){j&&(clearInterval(j), j=null)};c.fancyCountdown.reset=function(){b.find(".fc-digits li").stop(!0,!0);for(var a=0;4>a;++a)p&&p[a].text((8+a)%10),q&&q[a].text((4+a)%6),r&&r[a].text((8+a)%10),s&&s[a].text((4+a)%6),t&&t[a].text((8+a)%10),u&&u[a].text((1+a)%3),v&&v[a].text((8+a)%10),w&&w[a].text((8+a)%10),x&&x[a].text((8+a)%10)};c.fancyCountdown.fillColor=function(a){b.find(".fc-digitUnit, .fc-colon").css("background",a)};c.fancyCountdown.targetDate=function(b,e,f,j,k,l){j=j||0;k=k||0;l=l||0;a.year=parseInt(b);a.month=parseInt(e); a.day=parseInt(f);a.hour=parseInt(j);a.minute=parseInt(k);a.second=parseInt(l);B=!1;c.fancyCountdown.start()};c.fancyCountdown.timezone=function(b){a.timezone=parseFloat(b)};return this.each(function(){b=c(this);b.addClass("fc-panel").append('<div class="fc-digit-offset" style="display: none; position: relative;"></div>');a.digits.days&&(b.append('<div class="fc-days-wrapper"></div>'),2<a.dayDigitsAmount&&(x=f("days")),1<a.dayDigitsAmount&&(w=f("days")),0<a.dayDigitsAmount&&(v=f("days")),a.digits.days&& M());a.digits.hours&&(b.append('<div class="fc-hours-wrapper"></div>'),u=f("hours"),t=f("hours"),a.digits.minutes&&M());a.digits.minutes&&(b.append('<div class="fc-minutes-wrapper"></div>'),s=f("minutes"),r=f("minutes"),a.digits.seconds&&M());a.digits.seconds&&(b.append('<div class="fc-seconds-wrapper"></div>'),q=f("seconds"),p=f("seconds"));a.captions&&(parseInt(b.children(".fc-digitUnit").css("margin-right")),a.digits.days&&C(a.captionTitles.days,b.children(".fc-days-wrapper")),a.digits.hours&& C(a.captionTitles.hours,b.children(".fc-hours-wrapper")),a.digits.minutes&&C(a.captionTitles.minutes,b.children(".fc-minutes-wrapper")),a.digits.seconds&&C(a.captionTitles.seconds,b.children(".fc-seconds-wrapper")));a.autoStart&&c.fancyCountdown.start();c(window).blur(c.fancyCountdown.stop);c(window).focus(c.fancyCountdown.start)})};c.fn.fancyCountdown.defaults={year:2012,month:12,day:31,hour:0,minute:0,second:0,timezone:0,dayDigitsAmount:3,fillColor:"#22292A",borderColor:"#d5d5d5",autoStart:!0,captions:!0, digits:{days:!0,hours:!0,minutes:!0,seconds:!0},captionTitles:{days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds"},callback:function(){},overlayImageUrl:"images/fancyCountdown/overlay.png"}})(jQuery);